var g;(E=>{class a{constructor(t,i,e,n){this.version=t;this.errorCorrectionLevel=i;if(t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let r=[];for(let o=0;o<this.size;o++)r.push(!1);for(let o=0;o<this.size;o++)this.modules.push(r.slice()),this.isFunction.push(r.slice());this.drawFunctionPatterns();let s=this.addEccAndInterleave(e);if(this.drawCodewords(s),n==-1){let o=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);let l=this.getPenaltyScore();l<o&&(n=c,o=l),this.applyMask(c)}}f(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(t,i){let e=E.QrSegment.makeSegments(t);return a.encodeSegments(e,i)}static encodeBinary(t,i){let e=E.QrSegment.makeBytes(t);return a.encodeSegments([e],i)}static encodeSegments(t,i,e=1,n=40,r=-1,s=!0){if(!(a.MIN_VERSION<=e&&e<=n&&n<=a.MAX_VERSION)||r<-1||r>7)throw new RangeError("Invalid value");let o,c;for(o=e;;o++){let u=a.getNumDataCodewords(o,i)*8,b=h.getTotalBits(t,o);if(b<=u){c=b;break}if(o>=n)throw new RangeError("Data too long")}for(let u of[a.Ecc.MEDIUM,a.Ecc.QUARTILE,a.Ecc.HIGH])s&&c<=a.getNumDataCodewords(o,u)*8&&(i=u);let l=[];for(let u of t){y(u.mode.modeBits,4,l),y(u.numChars,u.mode.numCharCountBits(o),l);for(let b of u.getData())l.push(b)}f(l.length==c);let w=a.getNumDataCodewords(o,i)*8;f(l.length<=w),y(0,Math.min(4,w-l.length),l),y(0,(8-l.length%8)%8,l),f(l.length%8==0);for(let u=236;l.length<w;u^=253)y(u,8,l);let A=[];for(;A.length*8<l.length;)A.push(0);return l.forEach((u,b)=>A[b>>>3]|=u<<7-(b&7)),new a(o,i,A,r)}size;mask;modules=[];isFunction=[];getModule(t,i){return 0<=t&&t<this.size&&0<=i&&i<this.size&&this.modules[i][t]}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let t=this.getAlignmentPatternPositions(),i=t.length;for(let e=0;e<i;e++)for(let n=0;n<i;n++)e==0&&n==0||e==0&&n==i-1||e==i-1&&n==0||this.drawAlignmentPattern(t[e],t[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){let i=this.errorCorrectionLevel.formatBits<<3|t,e=i;for(let r=0;r<10;r++)e=e<<1^(e>>>9)*1335;let n=(i<<10|e)^21522;f(n>>>15==0);for(let r=0;r<=5;r++)this.setFunctionModule(8,r,d(n,r));this.setFunctionModule(8,7,d(n,6)),this.setFunctionModule(8,8,d(n,7)),this.setFunctionModule(7,8,d(n,8));for(let r=9;r<15;r++)this.setFunctionModule(14-r,8,d(n,r));for(let r=0;r<8;r++)this.setFunctionModule(this.size-1-r,8,d(n,r));for(let r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,d(n,r));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let e=0;e<12;e++)t=t<<1^(t>>>11)*7973;let i=this.version<<12|t;f(i>>>18==0);for(let e=0;e<18;e++){let n=d(i,e),r=this.size-11+e%3,s=Math.floor(e/3);this.setFunctionModule(r,s,n),this.setFunctionModule(s,r,n)}}drawFinderPattern(t,i){for(let e=-4;e<=4;e++)for(let n=-4;n<=4;n++){let r=Math.max(Math.abs(n),Math.abs(e)),s=t+n,o=i+e;0<=s&&s<this.size&&0<=o&&o<this.size&&this.setFunctionModule(s,o,r!=2&&r!=4)}}drawAlignmentPattern(t,i){for(let e=-2;e<=2;e++)for(let n=-2;n<=2;n++)this.setFunctionModule(t+n,i+e,Math.max(Math.abs(n),Math.abs(e))!=1)}setFunctionModule(t,i,e){this.modules[i][t]=e,this.isFunction[i][t]=!0}addEccAndInterleave(t){let i=this.version,e=this.errorCorrectionLevel;if(t.length!=a.getNumDataCodewords(i,e))throw new RangeError("Invalid argument");let n=a.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][i],r=a.ECC_CODEWORDS_PER_BLOCK[e.ordinal][i],s=Math.floor(a.getNumRawDataModules(i)/8),o=n-s%n,c=Math.floor(s/n),l=[],w=a.reedSolomonComputeDivisor(r);for(let u=0,b=0;u<n;u++){let m=t.slice(b,b+c-r+(u<o?0:1));b+=m.length;let R=a.reedSolomonComputeRemainder(m,w);u<o&&m.push(0),l.push(m.concat(R))}let A=[];for(let u=0;u<l[0].length;u++)l.forEach((b,m)=>{(u!=c-r||m>=o)&&A.push(b[u])});return f(A.length==s),A}drawCodewords(t){if(t.length!=Math.floor(a.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let i=0;for(let e=this.size-1;e>=1;e-=2){e==6&&(e=5);for(let n=0;n<this.size;n++)for(let r=0;r<2;r++){let s=e-r,c=(e+1&2)==0?this.size-1-n:n;!this.isFunction[c][s]&&i<t.length*8&&(this.modules[c][s]=d(t[i>>>3],7-(i&7)),i++)}}f(i==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let i=0;i<this.size;i++)for(let e=0;e<this.size;e++){let n;switch(t){case 0:n=(e+i)%2==0;break;case 1:n=i%2==0;break;case 2:n=e%3==0;break;case 3:n=(e+i)%3==0;break;case 4:n=(Math.floor(e/3)+Math.floor(i/2))%2==0;break;case 5:n=e*i%2+e*i%3==0;break;case 6:n=(e*i%2+e*i%3)%2==0;break;case 7:n=((e+i)%2+e*i%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[i][e]&&n&&(this.modules[i][e]=!this.modules[i][e])}}getPenaltyScore(){let t=0;for(let r=0;r<this.size;r++){let s=!1,o=0,c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[r][l]==s?(o++,o==5?t+=a.PENALTY_N1:o>5&&t++):(this.finderPenaltyAddHistory(o,c),s||(t+=this.finderPenaltyCountPatterns(c)*a.PENALTY_N3),s=this.modules[r][l],o=1);t+=this.finderPenaltyTerminateAndCount(s,o,c)*a.PENALTY_N3}for(let r=0;r<this.size;r++){let s=!1,o=0,c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][r]==s?(o++,o==5?t+=a.PENALTY_N1:o>5&&t++):(this.finderPenaltyAddHistory(o,c),s||(t+=this.finderPenaltyCountPatterns(c)*a.PENALTY_N3),s=this.modules[l][r],o=1);t+=this.finderPenaltyTerminateAndCount(s,o,c)*a.PENALTY_N3}for(let r=0;r<this.size-1;r++)for(let s=0;s<this.size-1;s++){let o=this.modules[r][s];o==this.modules[r][s+1]&&o==this.modules[r+1][s]&&o==this.modules[r+1][s+1]&&(t+=a.PENALTY_N2)}let i=0;for(let r of this.modules)i=r.reduce((s,o)=>s+(o?1:0),i);let e=this.size*this.size,n=Math.ceil(Math.abs(i*20-e*10)/e)-1;return f(0<=n&&n<=9),t+=n*a.PENALTY_N4,f(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{let t=Math.floor(this.version/7)+2,i=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2,e=[6];for(let n=this.size-7;e.length<t;n-=i)e.splice(1,0,n);return e}}static getNumRawDataModules(t){if(t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version number out of range");let i=(16*t+128)*t+64;if(t>=2){let e=Math.floor(t/7)+2;i-=(25*e-10)*e-55,t>=7&&(i-=36)}return f(208<=i&&i<=29648),i}static getNumDataCodewords(t,i){return Math.floor(a.getNumRawDataModules(t)/8)-a.ECC_CODEWORDS_PER_BLOCK[i.ordinal][t]*a.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let i=[];for(let n=0;n<t-1;n++)i.push(0);i.push(1);let e=1;for(let n=0;n<t;n++){for(let r=0;r<i.length;r++)i[r]=a.reedSolomonMultiply(i[r],e),r+1<i.length&&(i[r]^=i[r+1]);e=a.reedSolomonMultiply(e,2)}return i}static reedSolomonComputeRemainder(t,i){let e=i.map(n=>0);for(let n of t){let r=n^e.shift();e.push(0),i.forEach((s,o)=>e[o]^=a.reedSolomonMultiply(s,r))}return e}static reedSolomonMultiply(t,i){if(t>>>8||i>>>8)throw new RangeError("Byte out of range");let e=0;for(let n=7;n>=0;n--)e=e<<1^(e>>>7)*285,e^=(i>>>n&1)*t;return f(e>>>8==0),e}finderPenaltyCountPatterns(t){let i=t[1];f(i<=this.size*3);let e=i>0&&t[2]==i&&t[3]==i*3&&t[4]==i&&t[5]==i;return(e&&t[0]>=i*4&&t[6]>=i?1:0)+(e&&t[6]>=i*4&&t[0]>=i?1:0)}finderPenaltyTerminateAndCount(t,i,e){return t&&(this.finderPenaltyAddHistory(i,e),i=0),i+=this.size,this.finderPenaltyAddHistory(i,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(t,i){i[0]==0&&(t+=this.size),i.pop(),i.unshift(t)}static MIN_VERSION=1;static MAX_VERSION=40;static PENALTY_N1=3;static PENALTY_N2=3;static PENALTY_N3=40;static PENALTY_N4=10;static ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]];static NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]}E.QrCode=a;function y(p,t,i){if(t<0||t>31||p>>>t)throw new RangeError("Value out of range");for(let e=t-1;e>=0;e--)i.push(p>>>e&1)}function d(p,t){return(p>>>t&1)!=0}function f(p){if(!p)throw new Error("Assertion error")}class h{constructor(t,i,e){this.mode=t;this.numChars=i;this.bitData=e;if(i<0)throw new RangeError("Invalid argument");this.bitData=e.slice()}static makeBytes(t){let i=[];for(let e of t)y(e,8,i);return new h(h.Mode.BYTE,t.length,i)}static makeNumeric(t){if(!h.isNumeric(t))throw new RangeError("String contains non-numeric characters");let i=[];for(let e=0;e<t.length;){let n=Math.min(t.length-e,3);y(parseInt(t.substring(e,e+n),10),n*3+1,i),e+=n}return new h(h.Mode.NUMERIC,t.length,i)}static makeAlphanumeric(t){if(!h.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let i=[],e;for(e=0;e+2<=t.length;e+=2){let n=h.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e))*45;n+=h.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e+1)),y(n,11,i)}return e<t.length&&y(h.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e)),6,i),new h(h.Mode.ALPHANUMERIC,t.length,i)}static makeSegments(t){return t==""?[]:h.isNumeric(t)?[h.makeNumeric(t)]:h.isAlphanumeric(t)?[h.makeAlphanumeric(t)]:[h.makeBytes(h.toUtf8ByteArray(t))]}static makeEci(t){let i=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)y(t,8,i);else if(t<16384)y(2,2,i),y(t,14,i);else if(t<1e6)y(6,3,i),y(t,21,i);else throw new RangeError("ECI assignment value out of range");return new h(h.Mode.ECI,0,i)}static isNumeric(t){return h.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return h.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,i){let e=0;for(let n of t){let r=n.mode.numCharCountBits(i);if(n.numChars>=1<<r)return 1/0;e+=4+r+n.bitData.length}return e}static toUtf8ByteArray(t){t=encodeURI(t);let i=[];for(let e=0;e<t.length;e++)t.charAt(e)!="%"?i.push(t.charCodeAt(e)):(i.push(parseInt(t.substring(e+1,e+3),16)),e+=2);return i}static NUMERIC_REGEX=/^[0-9]*$/;static ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/;static ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"}E.QrSegment=h})(g||={});(y=>{let a;(f=>{class d{constructor(E,p){this.ordinal=E;this.formatBits=p}static LOW=new d(0,1);static MEDIUM=new d(1,0);static QUARTILE=new d(2,3);static HIGH=new d(3,2)}f.Ecc=d})(a=y.QrCode||={})})(g||={});(y=>{let a;(f=>{class d{constructor(E,p){this.modeBits=E;this.numBitsCharCount=p}static NUMERIC=new d(1,[10,12,14]);static ALPHANUMERIC=new d(2,[9,11,13]);static BYTE=new d(4,[8,16,16]);static KANJI=new d(8,[8,10,12]);static ECI=new d(7,[0,0,0]);numCharCountBits(E){return this.numBitsCharCount[Math.floor((E+7)/17)]}}f.Mode=d})(a=y.QrSegment||={})})(g||={});
